from django.http import HttpResponse
from django.shortcuts import render
import json

from wines import greedy_tsp

def root(request):
    """Generate the main page"""
    return render(request, 'root.html') 

def about(request):
    """Generate the about page"""
    return render(request, 'about.html') 

def search(request):
    """Generate the search page"""
    return render(request, 'search.html') 

def calculate(request):
    """Calculate optimal wine tour routes"""
    tsp_input = parse_query_string(request.META['QUERY_STRING'])
    routes = []
    #Populate routes with greedy_tsp
    #IMPORTANT
    #`routes` should be an ordered list of tuples, in order of best route to worst
    #Each tuple is of the following form:
    #(<start_address>, <end_address>, [list of stops IN ORDER that they are vistied])
    #See below for example
    routes.append(
	    ('2899 Joyce Lane, Merrick, NY, 11566', 
		'2899 Joyce Lane, Merrick, NY, 11566',
		['55 Ridgewood Road, Ithaca, NY 14850']))
    routes.append(
	    ('Amazon Headquarters, Seattle, WA 98119',
		'Amazon Headquarters, Seattle, WA 98119',
		['Space Needle, Seattle, WA 98119']))
    routes.append(
	    ('1600 Ampitheathre Parkway, Mountain View, CA 94043',
		'Amazon Headquarters, Seattle, WA 98119',
		['Space Needle, Seattle, WA 98119']))

    return HttpResponse(json.dumps(routes), content_type='application/json')

def parse_query_string(string):
    """Parses a query string into a usable form for greedy_tsp"""
    pass
